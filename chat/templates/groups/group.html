{% extends 'base.html' %}

{% load static %}

{% block title %} –ì—Ä—É–ø–ø–∞ {{ group.name|safe }} {% endblock %}

{% block content %}
  {% include '../includes/sidebar.html' %}
    <div class='content col-xl-9 h-100'>
      {% if is_member %}
        <h1 class='title' title='{{ group.slug }}'>–ß–∞—Ç: {{ group.name|safe }}</h1>
        <div class='chat col-12'>
            <div class="chat__options">
               {% if user.id == group.owner.id %}
                <a href='{% url 'groups:clear_messages_confirm' group.slug %}'>
                    –û—á–∏—Å—Ç–∏—Ç—å
                </a>
              {% endif %}
            </div>
            <div id='chat-log'>
              <span class='chat-log__title-message-container'>
                <span>
                ‚ú® <a href='{% url 'users:user_detail' group.owner.id %}'>{{ group.owner.username|capfirst }}</a> —Å–æ–∑–¥–∞–ª –≥—Ä—É–ø–ø—É {{ group.name }}! ‚ú®
                </span>
              </span>
              {% for message in messages.all %}
                {% if message.user == user %}
                  <div class='message current-user-message'>
                    <span class='message__author'>
                      {{ message.user.username }} 
                    </span>
                    <p class='message__text'>{{message.text|safe}}</p>
                    {% if message.text|length > 7 %}
                      <span class='message__time' style='{margin-top: 0}'>{{ message.time }} </span>
                    {% else %}
                      <span class='message__time'>{{ message.time }} </span>
                    {% endif %}
                  </div>
                {% else %}
                  <div class='message'>
                    <span class='message__author'>
                      {{ message.user.username }} 
                    </span>
                    <p class='message__text'>{{message.text|safe}}</p>
                    <span class='message__time'>{{ message.time }} </span>
                  </div>
                {% endif %}
              {% endfor %}
            </div>
            <div class='chat__sendings'>
              <textarea 
                      id='chat-message-input'
                      maxlength='1024'
                      placeholder='–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...'
                      rows='1'
                      ></textarea>
              <input id='chat-message-submit' type='button' value='–û—Ç–ø—Ä–∞–≤–∏—Ç—å'>
            </div>
        </div>
        <script type='text/javascript' src='{% static "js/auto_textarea_resizing.js" %}'></script>
        {% include '../includes/websocket_data.html' with connection_type=connection_type connection_name=group.slug %}
      {% else %}
        <h1 class='title'>–í—ã –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç–µ –≤ —ç—Ç–æ–π –≥—Ä—É–ø–ø–µ üòî</h1>
      {% endif %}
    </div>
{% endblock %}